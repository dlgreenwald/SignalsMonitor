{"version":3,"sources":["beeps.mp3","LoginModal.tsx","ThermoworksFirebase.tsx","TempDisplay.tsx","TempColumn.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","LoginModal","props","handleShow","bind","handleClose","handleChange","handleSubmit","state","show","username","password","loginSubmitted","nextProps","this","setState","event","target","name","value","onLogin","preventDefault","Button","style","width","margin","variant","onClick","Modal","Form","onSubmit","Header","Title","href","direction","size","octoColor","bannerColor","Body","Group","controlId","Label","Control","type","placeholder","onChange","Text","className","Footer","disabled","Spinner","as","animation","role","aria-hidden","Component","ThermoworksFirebase","fbInstance","uid","signalDevices","smokeDevices","tempData","probeState","onDataUpdate","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","Map","undefined","auth","signInWithEmailAndPassword","catch","error","errorCode","code","errorMessage","message","alert","console","log","currentUser","database","ref","child","once","forEach","device","devObj","toJSON","set","deviceName","probe1Name","probe2Name","probe3Name","probe4Name","signalsStart","smokeStart","deviceID","limitToLast","on","snapshot_","addSignalsTempData","addSmokeTempData","get","details","deviceDetails","temp","names","p1","length","toString","date","alarm","Boolean","alarmSounding","p1H","p1L","alarmHigh","alarms","alarmLow","max","maxmin","p1Max","min","p1Min","p2","p2H","p2L","p2Max","p2Min","p3","p3H","p3L","p3Max","p3Min","p4","p4H","p4L","p4Max","p4Min","a","record","data","d","Date","setUTCSeconds","Number","time","push","replaceSignalsProbeDetails","alarm1High","alarm1Low","probe1H","probe1L","minMax","probe1Max","probe1Min","alarm2High","alarm2Low","probe2H","probe2L","probe2Max","probe2Min","probe1","probe2","replaceSmokeProbeDetails","TempDisplay","isAlarming","probe","background","text","newBackground","newText","newIsAlarming","Card","cursor","bg","border","textAlign","padding","Container","fluid","Row","Col","xs","fontSize","writingMode","url","alarmFile","playStatus","Sound","status","PLAYING","STOPPED","loop","TempColumn","curTemps","probeDetails","TempElements","key","id","CardDeck","App","baselines","showLogin","setCredentials","setOnTempUpdate","onTempUpdate","init","newCurTemps","returnTempData","newTemps","newProbeDetails","returnProbeDetails","newBaselines","label","wb","XLSX","book_new","Props","sheetname","replace","SheetNames","Sheets","json_to_sheet","wbout","bookType","Blob","FileSaver","marginTop","height","x_accessor","y_accessor","right","area","brush","exportXLSX","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"0IAAAA,EAAOC,QAAU,IAA0B,mC,q6BCmG5BC,E,YA9Eb,WAAYC,GAAgB,IAAD,8BAC3B,4CAAMA,KAEDC,WAAa,EAAKA,WAAWC,KAAhB,gBAClB,EAAKC,YAAc,EAAKA,YAAYD,KAAjB,gBACjB,EAAKE,aAAe,EAAKA,aAAaF,KAAlB,gBACpB,EAAKG,aAAe,EAAKA,aAAaH,KAAlB,gBAEtB,EAAKI,MAAQ,CACZC,KAAMP,EAAMO,KACTC,SAAU,GACVC,SAAU,GACVC,gBAAe,GAZQ,E,uFAgBDC,GACxBC,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,CAA8BC,KAAKI,EAAUJ,U,oCAI/CK,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,CAA8BC,MAAM,O,mCAIpCK,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,CAA8BC,MAAM,EAAMG,gBAAe,O,mCAG5CI,GACX,IAAIC,EAAUD,EAAMC,OACpBH,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,eAA+BS,EAAOC,KAAOD,EAAOE,W,mCAGzCH,GACXF,KAAKZ,MAAMkB,QAAQN,KAAKN,MAAME,SAAUI,KAAKN,MAAMG,UACnDG,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,CAA8BI,gBAAe,KAC7CI,EAAMK,mB,+BAIN,OACE,oCACA,kBAACC,EAAA,EAAD,CAAQC,MAAO,CAACC,MAAM,QAASC,OAAO,QAASC,QAAQ,UAAUC,QAASb,KAAKX,YAA/E,eACA,kBAACyB,EAAA,EAAD,CAAOnB,KAAMK,KAAKN,MAAMC,MACxB,kBAACoB,EAAA,EAAD,CAAMC,SAAUhB,KAAKP,cACnB,kBAACqB,EAAA,EAAMG,OAAP,KACE,kBAACH,EAAA,EAAMI,MAAP,uCACA,kBAAC,IAAD,CAAcC,KAAK,gDAAgDC,UAAU,QAAQC,KAAK,KAAKC,UAAU,QAAQC,YAAY,UAE/H,kBAACT,EAAA,EAAMU,KAAP,KACE,kBAACT,EAAA,EAAKU,MAAN,CAAYC,UAAU,kBACpB,kBAACX,EAAA,EAAKY,MAAN,sBACA,kBAACZ,EAAA,EAAKa,QAAN,CAAcxB,KAAK,WAAWyB,KAAK,QAAQxB,MAAOL,KAAKN,MAAME,SAAUkC,YAAY,cAAcC,SAAU/B,KAAKR,eAChH,kBAACuB,EAAA,EAAKiB,KAAN,CAAWC,UAAU,cAArB,mDAKF,kBAAClB,EAAA,EAAKU,MAAN,CAAYC,UAAU,qBACpB,kBAACX,EAAA,EAAKY,MAAN,iBACA,kBAACZ,EAAA,EAAKa,QAAN,CAAcxB,KAAK,WAAWyB,KAAK,WAAWxB,MAAOL,KAAKN,MAAMG,SAAUiC,YAAY,WAAWC,SAAU/B,KAAKR,iBAIpH,kBAACsB,EAAA,EAAMoB,OAAP,KAEE,kBAAC1B,EAAA,EAAD,CAAQqB,KAAK,SAASjB,QAAQ,UAAUuB,SAAUnC,KAAKN,MAAMI,gBAA7D,SACSE,KAAKN,MAAMI,gBAAkB,kBAACsC,EAAA,EAAD,CAASC,GAAG,OAAOC,UAAU,OAAOjB,KAAK,KAAKkB,KAAK,SAASC,cAAY,kB,GArE/FC,a,QC8CZC,G,YAAb,WAWE,aAAe,yBAVfC,gBAUc,OATd/C,cASc,OARdC,cAQc,OAPd+C,SAOc,OANdC,mBAMc,OALdC,kBAKc,OAJdC,cAIc,OAHdC,gBAGc,OAFdC,kBAEc,EAEZjD,KAAK2C,WAAaO,gBAAuB,CACvCC,OAAQ,0CACRC,WAAY,8BACZC,YAAa,qCACbC,UAAW,cACXC,cAAe,0BACfC,kBAAmB,gBAGrBxD,KAAKJ,SAAW,GAChBI,KAAKH,SAAW,GAChBG,KAAK4C,IAAM,GACX5C,KAAK6C,cAAgB,IAAIY,IACzBzD,KAAK8C,aAAe,IAAIW,IACxBzD,KAAK+C,SAAW,IAAIU,IACpBzD,KAAKiD,kBAAeS,EACpB1D,KAAKgD,WAAa,IAAIS,IA7B1B,2DAgCiB7D,EAAiBC,GAC9BG,KAAKJ,SAAWA,EAChBI,KAAKH,SAAWA,IAlCpB,yJAsCIG,KAAK4C,IAAM,GACX5C,KAAK6C,cAAgB,IAAIY,IAvC7B,SAwCUzD,KAAK2C,WAAWgB,OAAOC,2BAA2B5D,KAAKJ,SAAUI,KAAKH,UAAUgE,OAAM,SAASC,GAEnG,IAAIC,EAAYD,EAAME,KAClBC,EAAeH,EAAMI,QACP,wBAAdH,EACFI,MAAM,mBAENA,MAAMF,GAERG,QAAQC,IAAIP,MAjDlB,cAmDI9D,KAAK4C,IAAM5C,KAAK2C,WAAWgB,OAAOW,YAAa1B,IAnDnD,SAuDoC5C,KAAK2C,WAAW4B,WAAWC,MAAMC,MAAM,SAASA,MAAMzE,KAAK4C,KAAK6B,MAAM,WAAWA,MAAM,WAAWC,KAAK,SAvD3I,qBAyDwBC,SAAQ,SAACC,GAC3B,IAAIC,EAASD,EAAOE,SAEpB,EAAKjC,cAAckC,IAAIF,EAAOG,WAAWH,GAEzC,EAAK9B,SAASgC,IAAIF,EAAOG,WAAW,IAAIH,EAAOI,WAAY,IAC3D,EAAKlC,SAASgC,IAAIF,EAAOG,WAAW,IAAIH,EAAOK,WAAY,IAC3D,EAAKnC,SAASgC,IAAIF,EAAOG,WAAW,IAAIH,EAAOM,WAAY,IAC3D,EAAKpC,SAASgC,IAAIF,EAAOG,WAAW,IAAIH,EAAOO,WAAY,IAG3D,EAAKC,aAAaR,MApExB,UAwEkC7E,KAAK2C,WAAW4B,WAAWC,MAAMC,MAAM,SAASA,MAAMzE,KAAK4C,KAAK6B,MAAM,WAAWA,MAAM,SAASC,KAAK,SAxEvI,eA0EsBC,SAAQ,SAACC,GACzB,IAAIC,EAASD,EAAOE,SACpB,EAAKhC,aAAaiC,IAAIF,EAAOzE,KAAKyE,GAElC,EAAK9B,SAASgC,IAAIF,EAAOzE,KAAK,WAAY,IAC1C,EAAK2C,SAASgC,IAAIF,EAAOzE,KAAK,WAAY,IAG1C,EAAKkF,WAAWT,MAlFtB,8IAwFI,OAAO7E,KAAK+C,WAxFhB,2CA6FI,OAAO/C,KAAKgD,aA7FhB,sCAgGkBC,GACdjD,KAAKiD,aAAeA,IAjGxB,mCAsGe2B,GAAwB,IAAD,OAClC5E,KAAK2C,WAAW4B,WAAWC,MAAMC,MAAM,eAAeA,MAAMG,EAAOW,UAAUC,YAAY,KAAKC,GAAG,SAAU,SAAAC,GAAS,OAAI,EAAKC,mBAAmBf,EAAOI,WAAYU,QAvGvK,iCA2Gad,GAAsB,IAAD,OAC9B5E,KAAK2C,WAAW4B,WAAWC,MAAMC,MAAM,aAAaA,MAAMG,EAAOA,QAAQY,YAAY,KAAKC,GAAG,SAAU,SAAAC,GAAS,OAAI,EAAKE,iBAAiBhB,EAAOxE,KAAMsF,QA5G3J,0FAiHmCV,GAjHnC,sFAmHQJ,EAAS5E,KAAK6C,cAAcgD,IAAIb,GAChCO,EAAkB,QACV7B,IAATkB,IACDW,EAASX,EAAOW,UAtHtB,SAyHwBvF,KAAK2C,WAAW4B,WAAWC,MAAMC,MAAM,WAAWA,MAAMc,GAAUC,YAAY,IAAId,KAAK,SAzH/G,OAyHQoB,EAzHR,OA0HQC,EAAgBD,EAAQhB,cAMhBpB,KADRsC,EAAOhG,KAAK+C,SAAS8C,IAAIb,EAAW,IAAIe,EAAcE,MAAMC,WACjBxC,IAAtBsC,EAAKA,EAAKG,OAAO,IACxCnG,KAAKgD,WAAW+B,IAAIC,EAAW,IAAIe,EAAcE,MAAMC,GAAI,CACzDF,KAAKA,EAAKA,EAAKG,OAAO,GAAG9F,MAAM+F,WAC/BC,KAAKL,EAAKA,EAAKG,OAAO,GAAGE,KACzBC,MAAMC,QAAQR,EAAcS,cAAcC,MAAMF,QAAQR,EAAcS,cAAcE,KACpFC,UAAUZ,EAAca,OAAOH,IAC/BI,SAASd,EAAca,OAAOF,IAC9BI,IAAIf,EAAcgB,OAAOC,MACzBC,IAAIlB,EAAcgB,OAAOG,MACzB9G,KAAK2F,EAAcE,MAAMC,UAMjBxC,KADZsC,EAAOhG,KAAK+C,SAAS8C,IAAIb,EAAW,IAAIe,EAAcE,MAAMkB,WACbzD,IAAtBsC,EAAKA,EAAKG,OAAO,IACxCnG,KAAKgD,WAAW+B,IAAIC,EAAW,IAAIe,EAAcE,MAAMkB,GAAI,CACzDnB,KAAKA,EAAKA,EAAKG,OAAO,GAAG9F,MAAM+F,WAC/BC,KAAKL,EAAKA,EAAKG,OAAO,GAAGE,KACzBC,MAAMC,QAAQR,EAAcS,cAAcY,MAAMb,QAAQR,EAAcS,cAAca,KACpFV,UAAUZ,EAAca,OAAOQ,IAC/BP,SAASd,EAAca,OAAOS,IAC9BP,IAAIf,EAAcgB,OAAOO,MACzBL,IAAIlB,EAAcgB,OAAOQ,MACzBnH,KAAK2F,EAAcE,MAAMkB,UAMjBzD,KADZsC,EAAOhG,KAAK+C,SAAS8C,IAAIb,EAAW,IAAIe,EAAcE,MAAMuB,WACb9D,IAAtBsC,EAAKA,EAAKG,OAAO,IACxCnG,KAAKgD,WAAW+B,IAAIC,EAAW,IAAIe,EAAcE,MAAMuB,GAAI,CACzDxB,KAAKA,EAAKA,EAAKG,OAAO,GAAG9F,MAAM+F,WAC/BC,KAAKL,EAAKA,EAAKG,OAAO,GAAGE,KACzBC,MAAMC,QAAQR,EAAcS,cAAciB,MAAMlB,QAAQR,EAAcS,cAAckB,KACpFf,UAAUZ,EAAca,OAAOa,IAC/BZ,SAASd,EAAca,OAAOc,IAC9BZ,IAAIf,EAAcgB,OAAOY,MACzBV,IAAIlB,EAAcgB,OAAOa,MACzBxH,KAAK2F,EAAcE,MAAMuB,UAMjB9D,KADZsC,EAAOhG,KAAK+C,SAAS8C,IAAIb,EAAW,IAAIe,EAAcE,MAAM4B,WACbnE,IAAtBsC,EAAKA,EAAKG,OAAO,IACxCnG,KAAKgD,WAAW+B,IAAIC,EAAW,IAAIe,EAAcE,MAAM4B,GAAI,CACzD7B,KAAKA,EAAKA,EAAKG,OAAO,GAAG9F,MAAM+F,WAC/BC,KAAKL,EAAKA,EAAKG,OAAO,GAAGE,KACzBC,MAAMC,QAAQR,EAAcS,cAAcsB,MAAMvB,QAAQR,EAAcS,cAAcuB,KACpFpB,UAAUZ,EAAca,OAAOkB,IAC/BjB,SAASd,EAAca,OAAOmB,IAC9BjB,IAAIf,EAAcgB,OAAOiB,MACzBf,IAAIlB,EAAcgB,OAAOkB,MACzB7H,KAAK2F,EAAcE,MAAM4B,KAtLjC,0LA2L2B7C,EAAmBkD,GA3L9C,qFA4LQtD,EAAS5E,KAAK6C,cAAcgD,IAAIb,GAEpCkD,EAAEvD,SAAQ,SAACwD,GACT,IAAIC,EAAOD,EAAOrD,SAEduD,EAAI,IAAIC,KAAK,GACjBD,EAAEE,cAAcC,OAAOJ,EAAKK,YAEd/E,IAAXkB,IACS,QAAVwD,EAAKlC,IAAY,EAAKnD,SAAS8C,IAAIjB,EAAOI,WAAW,IAAIJ,EAAOK,YAAayD,KAAK,CAACrC,KAAKgC,EAAGhI,MAAMmI,OAAOJ,EAAKlC,MACnG,QAAVkC,EAAKjB,IAAY,EAAKpE,SAAS8C,IAAIjB,EAAOI,WAAW,IAAIJ,EAAOM,YAAawD,KAAK,CAACrC,KAAKgC,EAAGhI,MAAMmI,OAAOJ,EAAKjB,MACnG,QAAViB,EAAKZ,IAAY,EAAKzE,SAAS8C,IAAIjB,EAAOI,WAAW,IAAIJ,EAAOO,YAAauD,KAAK,CAACrC,KAAKgC,EAAGhI,MAAMmI,OAAOJ,EAAKZ,MACnG,QAAVY,EAAKP,IAAY,EAAK9E,SAAS8C,IAAIjB,EAAOI,WAAW,IAAIJ,EAAOQ,YAAasD,KAAK,CAACrC,KAAKgC,EAAGhI,MAAMmI,OAAOJ,EAAKP,UAxMrH,SA6MU7H,KAAK2I,2BAA2B3D,GA7M1C,YA+M2BtB,IAApB1D,KAAKiD,cACNjD,KAAKiD,eAhNX,iMAqNiC+B,GArNjC,sFAsNQJ,EAAS5E,KAAK8C,aAAa+C,IAAIb,GAC/BO,EAAkB,QACV7B,IAATkB,IACDW,EAASX,EAAOA,QAzNtB,SA4NwB5E,KAAK2C,WAAW4B,WAAWC,MAAMC,MAAM,SAASA,MAAMc,GAAUC,YAAY,IAAId,KAAK,SA5N7G,OA4NQoB,EA5NR,OA6NQC,EAAgBD,EAAQhB,cAMhBpB,KADRsC,EAAOhG,KAAK+C,SAAS8C,IAAIb,EAAW,mBACOtB,IAAtBsC,EAAKA,EAAKG,OAAO,IACxCnG,KAAKgD,WAAW+B,IAAIC,EAAW,WAAY,CACzCgB,KAAKA,EAAKA,EAAKG,OAAO,GAAG9F,MAAM+F,WAC/BC,KAAKL,EAAKA,EAAKG,OAAO,GAAGE,KACzBC,MAAMC,QAAQR,EAAca,OAAOgC,aAAarC,QAAQR,EAAca,OAAOiC,WAC7ElC,UAAUZ,EAAca,OAAOkC,QAC/BjC,SAASd,EAAca,OAAOmC,QAC9BjC,IAAIf,EAAciD,OAAOC,UACzBhC,IAAIlB,EAAciD,OAAOE,UACzB9I,KAAK4E,SAMGtB,KADZsC,EAAOhG,KAAK+C,SAAS8C,IAAIb,EAAW,mBACWtB,IAAtBsC,EAAKA,EAAKG,OAAO,IACxCnG,KAAKgD,WAAW+B,IAAIC,EAAW,WAAY,CACzCgB,KAAKA,EAAKA,EAAKG,OAAO,GAAG9F,MAAM+F,WAC/BC,KAAKL,EAAKA,EAAKG,OAAO,GAAGE,KACzBC,MAAMC,QAAQR,EAAca,OAAOuC,aAAa5C,QAAQR,EAAca,OAAOwC,WAC7EzC,UAAUZ,EAAca,OAAOyC,QAC/BxC,SAASd,EAAca,OAAO0C,QAC9BxC,IAAIf,EAAciD,OAAOO,UACzBtC,IAAIlB,EAAciD,OAAOQ,UACzBpJ,KAAK4E,IA3Pb,wLAgQyBA,EAAmBkD,GAhQ5C,qFAiQQtD,EAAS5E,KAAK8C,aAAa+C,IAAIb,GAEnCkD,EAAEvD,SAAQ,SAACwD,GACT,IAAIC,EAAOD,EAAOrD,SAEduD,EAAI,IAAIC,KAAK,GACjBD,EAAEE,cAAcC,OAAOJ,EAAKK,YAEf/E,IAAVkB,IACa,MAAdwD,EAAKqB,QAAc,EAAK1G,SAAS8C,IAAIjB,EAAOxE,KAAK,YAAasI,KAAK,CAACrC,KAAKgC,EAAGhI,MAAMmI,OAAOJ,EAAKqB,UAChF,MAAdrB,EAAKsB,QAAc,EAAK3G,SAAS8C,IAAIjB,EAAOxE,KAAK,YAAasI,KAAK,CAACrC,KAAKgC,EAAGhI,MAAMmI,OAAOJ,EAAKsB,cA3QtG,SA+QU1J,KAAK2J,yBAAyB3E,GA/QxC,YAiR2BtB,IAApB1D,KAAKiD,cACNjD,KAAKiD,eAlRX,iH,mTC0BiB2G,E,YArEb,WAAYxK,GAAe,IAAD,8BACtB,4CAAMA,KAEDM,MAAQ,CACTmK,YAAW,EACXC,MAAM1K,EAAM0K,MACZ1J,KAAKhB,EAAMgB,KACX2J,WAAW,QACXC,KAAK,aARa,E,uFAYAjK,GACtB,IAAIiG,EAAcwC,OAAOxI,KAAKN,MAAMoK,MAAM9D,MACtCW,EAAmB6B,OAAOxI,KAAKN,MAAMoK,MAAMnD,WAC3CE,EAAkB2B,OAAOxI,KAAKN,MAAMoK,MAAMjD,UAE1CoD,EAAgC,QAChCC,EAA4B,YAC5BC,GAAgB,EAChBtD,EAAWb,GAAUA,EAAOW,IAC5BsD,EAAgB,QAChBC,EAAU,aAEVrD,EAAWb,IACXiE,EAAgB,UAChBC,EAAU,QACVC,GAAgB,GAEhBnE,EAAOW,IACPsD,EAAgB,SAChBC,EAAQ,QACRC,GAAgB,GAEpBnK,KAAKC,S,yVAAL,IAAkBD,KAAKN,MAAvB,CAA8BU,KAAKL,EAAUK,KAAM0J,MAAM/J,EAAU+J,MAAOC,WAAWE,EAAeD,KAAKE,EAASL,WAAWM,O,+BAI7H,OACI,oCACA,yBAAKlI,UAAU,qBACX,kBAACmI,EAAA,EAAD,CAAMnI,UAAU,WAAWxB,MAAO,CAAC4J,OAAQ,WAAYL,KAAMhK,KAAKN,MAAMsK,KAAMM,GAAItK,KAAKN,MAAMqK,WAAYQ,OAAO,QAC5G,kBAACH,EAAA,EAAKlJ,MAAN,CAAYT,MAAO,CAAC+J,UAAU,WAAYxK,KAAKN,MAAMU,MACrD,kBAACgK,EAAA,EAAK5I,KAAN,CAAWf,MAAO,CAACgK,QAAQ,IAC3B,kBAACC,EAAA,EAAD,CAAWC,OAAK,GACZ,kBAACC,EAAA,EAAD,CAAKnK,MAAO,CAACgK,QAAQ,IACjB,kBAACI,EAAA,EAAD,CAAKC,GAAG,IAAIrK,MAAO,CAACgK,QAAQ,IACxB,kBAACG,EAAA,EAAD,CAAKnK,MAAO,CAACgK,QAAQ,IAAI,kBAACI,EAAA,EAAD,KAAK,kBAACD,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,WAAYN,QAAQ,EAAG9J,OAAO,IAApD,YAAsE,kBAACiK,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,QAASN,QAAQ,EAAG9J,OAAO,IAAKX,KAAKN,MAAMoK,MAAMjD,YAC3K,kBAAC+D,EAAA,EAAD,CAAKnK,MAAO,CAACgK,QAAQ,IAAI,kBAACI,EAAA,EAAD,KAAK,kBAACD,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,WAAYN,QAAQ,EAAG9J,OAAO,IAApD,YAAsE,kBAACiK,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,QAASN,QAAQ,EAAG9J,OAAO,IAAKX,KAAKN,MAAMoK,MAAMnD,cAE/K,kBAACkE,EAAA,EAAD,CAAKC,GAAG,IAAIrK,MAAO,CAACgK,QAAQ,IACxB,kBAACG,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,YAAaC,YAAY,cAAeP,QAAQ,IAAKzK,KAAKN,MAAMoK,MAAM9D,KAA5F,SAEJ,kBAAC6E,EAAA,EAAD,CAAKC,GAAG,IAAIrK,MAAO,CAACgK,QAAQ,IACxB,kBAACG,EAAA,EAAD,CAAKnK,MAAO,CAACgK,QAAQ,IAAI,kBAACI,EAAA,EAAD,KAAK,kBAACD,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,WAAYN,QAAQ,EAAG9J,OAAO,IAApD,OAAiE,kBAACiK,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,QAASN,QAAQ,EAAG9J,OAAO,IAAKX,KAAKN,MAAMoK,MAAM7C,OACtK,kBAAC2D,EAAA,EAAD,CAAKnK,MAAO,CAACgK,QAAQ,IAAI,kBAACI,EAAA,EAAD,KAAK,kBAACD,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,WAAYN,QAAQ,EAAG9J,OAAO,IAApD,OAAiE,kBAACiK,EAAA,EAAD,CAAKnK,MAAO,CAACsK,SAAS,QAASN,QAAQ,EAAG9J,OAAO,IAAKX,KAAKN,MAAMoK,MAAMhD,UAIlL,kBAAC,IAAD,CAAOmE,IAAKC,IAAWC,WAAYnL,KAAKN,MAAMmK,WAAWuB,IAAMC,OAAOC,QAAQF,IAAMC,OAAOE,QAASC,MAAM,Y,GA5DlG/I,aC2BXgJ,E,YA/Bb,WAAYrM,GAAe,IAAD,8BACtB,4CAAMA,KAEDM,MAAS,CACVgM,SAAStM,EAAMsM,SACfC,aAAavM,EAAMuM,cALD,E,uFASA5L,GACtBC,KAAKC,SAAS,CAAEyL,SAAU3L,EAAU2L,SAAUC,aAAa5L,EAAU4L,iB,+BAIrE,IAAIC,EAAkC,GAItC,OAHA5L,KAAKN,MAAMiM,aAAahH,SAAQ,SAACC,EAAQiH,GAAT,OAC5BD,EAAalD,KAAK,kBAAC,EAAD,CAAatI,KAAMyL,EAAK/B,MAAOlF,QAGjD,oCACA,yBAAKkH,GAAG,oBAAoB7J,UAAU,OAClC,kBAAC8J,EAAA,EAAD,CAAUD,GAAG,WAAW7J,UAAU,OAC7B2J,S,GAvBMnJ,a,smBCwIZuJ,E,YA7Hb,WAAYtM,GAAe,IAAD,8BACxB,4CAAMA,KAEDA,MAAQ,CACXwD,SAAU,IAAIR,EACdK,SAAW,GACXkJ,UAAW,GACXP,SAAU,IAAIjI,IACdkI,aAAc,IAAIlI,IAClByI,WAAU,GATY,E,8GAaZtM,EAAiBC,G,wEAC7BG,KAAKN,MAAMwD,SAASiJ,eAAevM,EAAUC,GAC7CG,KAAKN,MAAMwD,SAASkJ,gBAAgBpM,KAAKqM,aAAa/M,KAAKU,O,SACrDA,KAAKN,MAAMwD,SAASoJ,O,OAC1BtM,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,CAA8BwM,WAAU,K,8IAKxC,IAAIK,EAA8D,IAAI9I,IACtEzD,KAAKN,MAAMwD,SAASsJ,iBAAiB7H,SAAQ,SAACmF,EAAO+B,GACnDU,EAAYxH,IAAI8G,EAAK/B,EAAMA,EAAM3D,OAAO,OAI1C,IAAIsG,EAA0D,GAC9DzM,KAAKN,MAAMwD,SAASsJ,iBAAiB7H,SAAQ,SAACmF,GAC1B,IAAfA,EAAM3D,QACPsG,EAAS/D,KAAKoB,MAIlB,IAAI4C,EAAkB1M,KAAKN,MAAMwD,SAASyJ,qBAEtCC,EAAoD,GACxD5M,KAAKN,MAAMwD,SAASyJ,qBAAqBhI,SAAQ,SAACtE,EAAOwL,GACvDe,EAAalE,KAAK,CAACrI,MAAMmI,OAAOnI,EAAMsG,WAAYkG,MAAMhB,EAAI,UACxC,OAAjBxL,EAAMwG,UACP+F,EAAalE,KAAK,CAACrI,MAAMmI,OAAOnI,EAAMwG,UAAWgG,MAAMhB,EAAI,YAI/D7L,KAAKC,SAAL,KAAkBD,KAAKN,MAAvB,CACEqD,SAAS0J,EAAUf,SAASa,EAAaZ,aAAae,EAAiBT,UAAUW,O,uJAKlE,kFACK,SAGlBE,EAAKC,QAAWC,YACjBC,MAAQ,CACT/L,MAAO,+BAGTlB,KAAKN,MAAMwD,SAASsJ,iBAAiB7H,SAAQ,SAACtE,EAAOwL,GACnD,GAAkB,IAAfxL,EAAM8F,OAAW,CAClB,IAAI+G,EAAYrB,EAAIsB,QAAQ,IAAI,KAChCL,EAAGM,WAAW1E,KAAKwE,GACnBJ,EAAGO,OAAOH,GAAaH,QAAWO,cAAcjN,OAMhDkN,EAAQR,QAAWD,EAAI,CAACU,SAAS,OAAS3L,KAAM,UAC9CuG,EAAO,IAAIqF,KAAK,CAACF,GAAQ,CAAC1L,KApBf,oFAqBjB6L,SAAiBtF,EAAM,c,qIAGf,IAAD,OACP,OACE,yBAAK0D,GAAG,MAAMrL,MAAO,CAACgK,QAAQ,EAAG9J,OAAO,IAAKsB,UAAU,OACrD,kBAAC,IAAD,CAAcd,KAAK,gDAAgDC,UAAU,OAAOE,UAAU,UAAUC,YAAY,SACpH,yBAAKuK,GAAG,YAAarL,MAAO,CAACkN,UAAU,IAAK1L,UAAU,OACpD,yBAAK6J,GAAG,kBAAkB7J,UAAU,OAClC,yBAAK6J,GAAG,UAAR,+BAIF,yBAAKA,GAAG,OAAO7J,UAAU,OACvB,yBAAK6J,GAAG,QACN,yBAAKA,GAAG,iBAAiB7J,UAAU,OACjC,kBAAC,IAAD,MACG,gBAAGvB,EAAH,EAAGA,MAAH,EAAUkN,OAAV,OACC,kBAAC,IAAD,CACExF,KAAM,EAAK1I,MAAMqD,SACjBrC,MAAOA,EACPkN,OAAQ,IACRC,WAAW,OACXC,WAAW,QACXC,MAAM,KACNC,KAAK,QACLC,MAAM,KACNhC,UAAW,EAAKvM,MAAMuM,gBAK9B,kBAAC,EAAD,CAAYP,SAAU1L,KAAKN,MAAMgM,SAAUC,aAAc3L,KAAKN,MAAMiM,eACpE,yBAAKG,GAAG,kBAAkB7J,UAAU,OAClC,yBAAK6J,GAAG,UAAU7J,UAAU,OAC1B,kBAAC,EAAD,CAAYtC,KAAMK,KAAKN,MAAMwM,UAAW5L,QAASN,KAAKM,QAAQhB,KAAKU,QACnE,kBAACQ,EAAA,EAAD,CAAQC,MAAO,CAACC,MAAM,QAASC,OAAO,QAASE,QAASb,KAAKkO,WAAW5O,KAAKU,OAA7E,uBAKR,yBAAK8L,GAAG,SAAS7J,UAAU,OACzB,yBAAK6J,GAAG,kBAAkB7J,UAAU,e,GAnH9BQ,aCdE8D,QACW,cAA7B4H,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OAAO,kBAAC,EAAD,MAASC,SAASC,eAAe,SDmI3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.72026e93.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/beeps.927d19ee.mp3\";","import React, { Component } from 'react';\nimport './App.css';\nimport Button from 'react-bootstrap/Button'\nimport Form from 'react-bootstrap/Form'\nimport Modal from 'react-bootstrap/Modal'\nimport GithubCorner from 'react-github-corner';\nimport Spinner from 'react-bootstrap/Spinner'\n\ninterface MyProps {\n  show:boolean,\n  onLogin:(username:string, password:string) => any;\n};\ninterface MyState {\n  show: boolean\n  username: string\n  password: string\n  loginSubmitted:boolean\n};\n\nclass LoginModal extends Component<MyProps, MyState> {\n\n  constructor(props:MyProps) {\n\t\tsuper(props);\n\n\t\tthis.handleShow = this.handleShow.bind(this);\n\t\tthis.handleClose = this.handleClose.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n\n\t\tthis.state = {\n\t\t\tshow: props.show,\n      username: '',\n      password: '',\n      loginSubmitted:false\n\t\t};\n  }\n\n  componentWillReceiveProps(nextProps:MyProps) {\n    this.setState({...this.state, show:nextProps.show});  \n  }\n\n  handleClose() {\n\t\tthis.setState({...this.state, show: false });\n\t}\n\n\thandleShow() {\n\t\tthis.setState({...this.state, show: true, loginSubmitted:false});\n\t}\n\n  handleChange(event: React.FormEvent) {\n    let target = (event.target as HTMLInputElement);\n    this.setState({...this.state, [target.name]: target.value});\n  }\n\n  handleSubmit(event:React.FormEvent<HTMLFormElement>) {\n    this.props.onLogin(this.state.username, this.state.password);\n    this.setState({...this.state, loginSubmitted:true });\n    event.preventDefault();\n  }\n\n  render() {\n    return (\n      <>\n      <Button style={{width:\"250px\", margin:\"15px\"}} variant=\"primary\" onClick={this.handleShow}>Get Started</Button>\n      <Modal show={this.state.show}>\n      <Form onSubmit={this.handleSubmit}>\n        <Modal.Header>\n          <Modal.Title>Login with Thermoworks Account</Modal.Title>\n          <GithubCorner href=\"https://github.com/dlgreenwald/SignalsMontior\" direction=\"right\" size=\"60\" octoColor=\"white\" bannerColor=\"grey\" />\n        </Modal.Header>\n        <Modal.Body>\n          <Form.Group controlId=\"formBasicEmail\">\n            <Form.Label>Email address</Form.Label>\n            <Form.Control name=\"username\" type=\"email\" value={this.state.username} placeholder=\"Enter email\" onChange={this.handleChange}/>\n            <Form.Text className=\"text-muted\">\n              We'll never share your email with anyone else.\n            </Form.Text>\n          </Form.Group>\n\n          <Form.Group controlId=\"formBasicPassword\">\n            <Form.Label>Password</Form.Label>\n            <Form.Control name=\"password\" type=\"password\" value={this.state.password} placeholder=\"Password\" onChange={this.handleChange}/>\n          </Form.Group>\n\n        </Modal.Body>\n        <Modal.Footer>\n\n          <Button type=\"submit\" variant=\"primary\" disabled={this.state.loginSubmitted}>\n            Login {this.state.loginSubmitted && <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\"/>}\n          </Button>\n        </Modal.Footer>\n        </Form>\n      </Modal>\n      </>\n    );\n  }\n\n}\n\nexport default LoginModal;","import * as firebase from 'firebase/app';\nimport \"firebase/database\";\nimport \"firebase/auth\";\n\ninterface ISignalsDevice {\n  deviceID:string;\n  dateAdded:string;\n  deviceName:string;\n  fan:string;\n  probe1Name:string;\n  probe2Name:string;\n  probe3Name:string;\n  probe4Name:string;\n  wifiOnly:string;\n}\n\ninterface ISmokeDevice {\n  device:string;\n  added:string;\n  name:string;\n  serial:string;\n}\n\ninterface ISignalsTempRecord{\n  p1:string,\n  p2:string,\n  p3:string,\n  p4:string,\n  time:string\n}\n\ninterface ISmokeTempRecord{\n  probe1:string,\n  probe2:string,\n  time:string\n}\n\ninterface ISignalsDeviceDetails{\n  alarmSounding:{p1H:string, p1L:string, p2H:string, p2L:string, p3H:string, p3L:string, p4H:string, p4L:string},\n  alarmSwitch:{p1Switch:string, p2Switch:string, p3Switch:string, p4Switch:string},\n  alarms:{p1H:string, p1L:string, p2H:string, p2L:string, p3H:string, p3L:string, p4H:string, p4L:string},\n  calibration:{p1:string, p2:string, p3:string, p4:string},\n  data:{battery:string, firmware:string, wifi:string},\n  fan:{alarm:string, connection:string, setTemp:string},\n  maxmin:{p1Max:string, p1Min:string, p2Max:string, p2Min:string, p3Max:string, p3Min:string, p4Max:string, p4Min:string},\n  migrated:boolean,\n  muted: {p1:string, p2:string, p3:string, p4:string},\n  names: {device:string, p1:string, p2:string, p3:string, p4:string},\n  resetmaxmin:{p1:string, p2:string, p3:string, p4:string},\n  rings:{p1:string, p2:string, p3:string, p4:string},\n  rssi:{lastupdate:string, level:string},\n  tempunit:{unit:string}\n}\n\ninterface ISmokeDeviceDetails{\n    alarms:{ alarm1High:boolean, alarm1Low:boolean, alarm2High:boolean, alarm2Low:boolean, probe1H:string, probe1L:string, probe2H:string, probe2L:string},\n    data:{battery:number,firmware:string,wifi:number},\n    hidden:{probe1:boolean, probe2:boolean, showMaxMinP1:boolean, showMaxMinP2:true},\n    minMax:{probe1Max:string, probe1Min:string, probe2Max:string, probe2Min:string},\n    notification:{trigger1H:boolean, trigger1L:boolean, trigger2H:boolean, trigger2L:boolean, triggerLoss:boolean},\n    probeNames:{probe1:string, probe2:string},\n    unit:{probe1:string,probe2:string},\n    update:{canUpdate:boolean,time:number}\n}\n\nexport class ThermoworksFirebase {\n  fbInstance: firebase.app.App;\n  username: string;\n  password: string;\n  uid: string;\n  signalDevices: Map<String, ISignalsDevice>;\n  smokeDevices: Map<String, ISmokeDevice>;\n  tempData:Map<string, Array<{ 'date': Date; 'value': number; }>>;\n  probeState:Map<string, { \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string}>;\n  onDataUpdate?:() => any;\n\n  constructor() {\n    //these were mined from the android APK... hopefully they don't mind too much\n    this.fbInstance = firebase.initializeApp({\n      apiKey: 'AIzaSyCfCUKlG5-VPsqta-9M92XBSFLHYsbSqLk',\n      authDomain: 'smoke-cloud.firebaseapp.com',\n      databaseURL: 'https://smoke-cloud.firebaseio.com',\n      projectId: 'smoke-cloud',\n      storageBucket: 'smoke-cloud.appspot.com',\n      messagingSenderId: '74663406178'\n    });\n\n    this.username = '';\n    this.password = '';\n    this.uid = '';\n    this.signalDevices = new Map();\n    this.smokeDevices = new Map();\n    this.tempData = new Map();\n    this.onDataUpdate = undefined;\n    this.probeState = new Map();\n  }\n\n  setCredentials(username:string, password:string){\n    this.username = username;\n    this.password = password;\n  }\n\n  async init(){\n    this.uid = '';\n    this.signalDevices = new Map();\n    await this.fbInstance.auth().signInWithEmailAndPassword(this.username, this.password).catch(function(error) {\n      // Handle Errors here.  @TODO probably need a better way of handling errors with a callback.\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      if (errorCode === 'auth/wrong-password') {\n        alert('Wrong password.');\n      } else {\n        alert(errorMessage);\n      }\n      console.log(error);\n    });\n    this.uid = this.fbInstance.auth().currentUser!.uid;\n\n    //we have to wait for this to come back once to finish init, but we also need to subscribe to changes.\n    //init signals devices\n    var signalsDevicesQuery = await this.fbInstance.database().ref().child(\"users\").child(this.uid).child(\"devices\").child(\"signals\").once(\"value\");\n  \n    signalsDevicesQuery.forEach((device) => {\n      var devObj = device.toJSON() as ISignalsDevice;\n\n      this.signalDevices.set(devObj.deviceName,devObj);\n      //init empty temp data\n      this.tempData.set(devObj.deviceName+\":\"+devObj.probe1Name, [])\n      this.tempData.set(devObj.deviceName+\":\"+devObj.probe2Name, [])\n      this.tempData.set(devObj.deviceName+\":\"+devObj.probe3Name, [])\n      this.tempData.set(devObj.deviceName+\":\"+devObj.probe4Name, [])\n\n      //subscribe to update events on each device\n      this.signalsStart(devObj);\n    });\n\n    //This actually won't work yet, I don't know the dataformat of a user with a smoke device.\n    var smokeDevicesQuery = await this.fbInstance.database().ref().child(\"users\").child(this.uid).child(\"devices\").child(\"smoke\").once(\"value\");\n\n    smokeDevicesQuery.forEach((device) => {\n      var devObj = device.toJSON() as ISmokeDevice;\n      this.smokeDevices.set(devObj.name,devObj);\n      //init empty temp data\n      this.tempData.set(devObj.name+\":Probe 1\", [])\n      this.tempData.set(devObj.name+\":Probe 2\", [])\n\n      //subscribe to update events on each device\n      this.smokeStart(devObj);\n    });\n  }\n\n  //Returns temp data for all probes on both smoke and signals devices\n  returnTempData(): Map<string, Array<{ 'date': Date; 'value': number; }>>{\n    return this.tempData;\n  }\n\n //@TODO make this return type a interface that is imported (or exported)\n  returnProbeDetails(): Map<string, { \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string}>{\n    return this.probeState; \n  }\n\n  setOnTempUpdate(onDataUpdate:() => any){\n    this.onDataUpdate = onDataUpdate;\n  }\n\n\n  //This starts a ongoing query with firebase for updates on a sepcific signal device\n  signalsStart(device: ISignalsDevice){\n    this.fbInstance.database().ref().child(\"SignalTemps\").child(device.deviceID).limitToLast(100).on(\"value\", (snapshot_ => this.addSignalsTempData(device.deviceName, snapshot_)));\n  }\n  \n  //This starts a ongoing query with firebase for updates on a sepcific smoke device\n  smokeStart(device: ISmokeDevice){\n    this.fbInstance.database().ref().child(\"smokeTemp\").child(device.device).limitToLast(100).on(\"value\", (snapshot_ => this.addSmokeTempData(device.name, snapshot_)));\n  }\n\n  //This fetches and replaces the signals device details.  It's current called once fore each temp update.  \n  //@TODO It would probably be better for it to have a similar update method as addTempData, both methods should call a common convert function. That way we make fewer calls to the database\n  async replaceSignalsProbeDetails(deviceName:string){\n    //lets do the conversion here rather than when requested.\n    var device = this.signalDevices.get(deviceName);\n    var deviceID:string = \"\";\n    if(device!==undefined){\n      deviceID=device.deviceID;\n    }\n\n    var details = await this.fbInstance.database().ref().child(\"signals\").child(deviceID).limitToLast(20).once(\"value\");\n    var deviceDetails = details.toJSON() as ISignalsDeviceDetails\n    \n    //It pains me to write code like this, but it's unavoidable with the way the data is stuctured.\n    //The best thing we can do is restructure the data as soon as we have it.\n    //P1\n    var temp = this.tempData.get(deviceName+\":\"+deviceDetails.names.p1)\n    if(temp !== undefined && temp[temp.length-1]!==undefined){\n      this.probeState.set(deviceName+\":\"+deviceDetails.names.p1, {\n        temp:temp[temp.length-1].value.toString(),\n        date:temp[temp.length-1].date,\n        alarm:Boolean(deviceDetails.alarmSounding.p1H)||Boolean(deviceDetails.alarmSounding.p1L),\n        alarmHigh:deviceDetails.alarms.p1H,\n        alarmLow:deviceDetails.alarms.p1L,\n        max:deviceDetails.maxmin.p1Max,\n        min:deviceDetails.maxmin.p1Min,\n        name:deviceDetails.names.p1\n      });\n    }\n\n    //P2\n    temp = this.tempData.get(deviceName+\":\"+deviceDetails.names.p2)\n    if(temp !== undefined && temp[temp.length-1]!==undefined){\n      this.probeState.set(deviceName+\":\"+deviceDetails.names.p2, {\n        temp:temp[temp.length-1].value.toString(),\n        date:temp[temp.length-1].date,\n        alarm:Boolean(deviceDetails.alarmSounding.p2H)||Boolean(deviceDetails.alarmSounding.p2L),\n        alarmHigh:deviceDetails.alarms.p2H,\n        alarmLow:deviceDetails.alarms.p2L,\n        max:deviceDetails.maxmin.p2Max,\n        min:deviceDetails.maxmin.p2Min,\n        name:deviceDetails.names.p2\n      });\n    }\n\n    //P3\n    temp = this.tempData.get(deviceName+\":\"+deviceDetails.names.p3)\n    if(temp !== undefined && temp[temp.length-1]!==undefined){\n      this.probeState.set(deviceName+\":\"+deviceDetails.names.p3, {\n        temp:temp[temp.length-1].value.toString(),\n        date:temp[temp.length-1].date,\n        alarm:Boolean(deviceDetails.alarmSounding.p3H)||Boolean(deviceDetails.alarmSounding.p3L),\n        alarmHigh:deviceDetails.alarms.p3H,\n        alarmLow:deviceDetails.alarms.p3L,\n        max:deviceDetails.maxmin.p3Max,\n        min:deviceDetails.maxmin.p3Min,\n        name:deviceDetails.names.p3\n      });\n    }\n\n    //P4\n    temp = this.tempData.get(deviceName+\":\"+deviceDetails.names.p4)\n    if(temp !== undefined && temp[temp.length-1]!==undefined){\n      this.probeState.set(deviceName+\":\"+deviceDetails.names.p4, {\n        temp:temp[temp.length-1].value.toString(),\n        date:temp[temp.length-1].date,\n        alarm:Boolean(deviceDetails.alarmSounding.p4H)||Boolean(deviceDetails.alarmSounding.p4L),\n        alarmHigh:deviceDetails.alarms.p4H,\n        alarmLow:deviceDetails.alarms.p4L,\n        max:deviceDetails.maxmin.p4Max,\n        min:deviceDetails.maxmin.p4Min,\n        name:deviceDetails.names.p4\n      });\n    }\n  }\n  \n  async addSignalsTempData(deviceName:string, a:firebase.database.DataSnapshot){\n    var device = this.signalDevices.get(deviceName);\n\n    a.forEach((record:firebase.database.DataSnapshot) => {\n      var data = record.toJSON() as ISignalsTempRecord;\n\n      var d = new Date(0);\n      d.setUTCSeconds(Number(data.time));\n\n      if(device !== undefined){\n        data.p1!==\"---\"&&this.tempData.get(device.deviceName+\":\"+device.probe1Name)!.push({date:d, value:Number(data.p1)});\n        data.p2!==\"---\"&&this.tempData.get(device.deviceName+\":\"+device.probe2Name)!.push({date:d, value:Number(data.p2)});\n        data.p3!==\"---\"&&this.tempData.get(device.deviceName+\":\"+device.probe3Name)!.push({date:d, value:Number(data.p3)});\n        data.p4!==\"---\"&&this.tempData.get(device.deviceName+\":\"+device.probe4Name)!.push({date:d, value:Number(data.p4)});\n  \n      }\n    });\n\n    await this.replaceSignalsProbeDetails(deviceName);\n\n    if(this.onDataUpdate!==undefined){\n      this.onDataUpdate();\n    }\n\n  }\n\n  async replaceSmokeProbeDetails(deviceName:string){\n    var device = this.smokeDevices.get(deviceName);\n    var deviceID:string = \"\";\n    if(device!==undefined){\n      deviceID=device.device;\n    }\n\n    var details = await this.fbInstance.database().ref().child(\"smoke\").child(deviceID).limitToLast(20).once(\"value\");\n    var deviceDetails = details.toJSON() as ISmokeDeviceDetails;\n\n    //It pains me to write code like this, but it's unavoidable with the way the data is stuctured.\n    //The best thing we can do is restructure the data as soon as we have it.\n    //P1\n    var temp = this.tempData.get(deviceName+\":Probe 1\")\n    if(temp !== undefined && temp[temp.length-1]!==undefined){\n      this.probeState.set(deviceName+\":Probe 1\", {\n        temp:temp[temp.length-1].value.toString(),\n        date:temp[temp.length-1].date,\n        alarm:Boolean(deviceDetails.alarms.alarm1High)||Boolean(deviceDetails.alarms.alarm1Low),\n        alarmHigh:deviceDetails.alarms.probe1H,\n        alarmLow:deviceDetails.alarms.probe1L,\n        max:deviceDetails.minMax.probe1Max,\n        min:deviceDetails.minMax.probe1Min,\n        name:deviceName\n      });\n    }\n\n    //P2\n    temp = this.tempData.get(deviceName+\":Probe 2\")\n    if(temp !== undefined && temp[temp.length-1]!==undefined){\n      this.probeState.set(deviceName+\":Probe 2\", {\n        temp:temp[temp.length-1].value.toString(),\n        date:temp[temp.length-1].date,\n        alarm:Boolean(deviceDetails.alarms.alarm2High)||Boolean(deviceDetails.alarms.alarm2Low),\n        alarmHigh:deviceDetails.alarms.probe2H,\n        alarmLow:deviceDetails.alarms.probe2L,\n        max:deviceDetails.minMax.probe2Max,\n        min:deviceDetails.minMax.probe2Min,\n        name:deviceName\n      });\n    }\n  }\n\n  async addSmokeTempData(deviceName:string, a:firebase.database.DataSnapshot){\n    var device = this.smokeDevices.get(deviceName);\n\n    a.forEach((record:firebase.database.DataSnapshot) => {\n      var data = record.toJSON() as ISmokeTempRecord;\n\n      var d = new Date(0);\n      d.setUTCSeconds(Number(data.time));\n\n      if(device!== undefined){\n        data.probe1!==\"-\"&&this.tempData.get(device.name+\":Probe 1\")!.push({date:d, value:Number(data.probe1)});\n        data.probe2!==\"-\"&&this.tempData.get(device.name+\":Probe 2\")!.push({date:d, value:Number(data.probe2)});\n      }\n    });\n\n    await this.replaceSmokeProbeDetails(deviceName);\n\n    if(this.onDataUpdate!==undefined){\n      this.onDataUpdate();\n    }\n\n  }\n\n}\n\n","import React, { Component } from 'react';\nimport './App.css';\nimport Row from 'react-bootstrap/Row'\nimport Col from 'react-bootstrap/Col'\nimport Card from 'react-bootstrap/Card'\nimport {CardProps} from 'react-bootstrap/Card'\nimport Container from 'react-bootstrap/Container'\nimport Sound from 'react-sound'\nimport alarmFile from './beeps.mp3'\n\ninterface MyProps {\n    name: string, \n    probe:{ \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string},\n};\ninterface MyState {\n    name: string, \n    isAlarming:boolean;\n    background:CardProps[\"bg\"],\n    text:CardProps[\"text\"],\n    probe:{ \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string}};\n  \n  class TempDisplay extends Component<MyProps, MyState> {\n    constructor(props:MyProps){\n        super(props);\n\n        this.state = {\n            isAlarming:false,\n            probe:props.probe,\n            name:props.name,\n            background:\"light\",\n            text:\"secondary\"\n        }\n    }\n\n    componentWillReceiveProps(nextProps:MyProps) {\n        var temp:Number = Number(this.state.probe.temp);\n        var alarmHigh:Number = Number(this.state.probe.alarmHigh);\n        var alarmLow:Number = Number(this.state.probe.alarmLow);\n\n        var newBackground:CardProps[\"bg\"] = 'light';\n        var newText:CardProps[\"text\"] = \"secondary\";\n        var newIsAlarming = false;\n        if((alarmLow < temp) && (temp < alarmHigh)){\n            newBackground = 'light';\n            newText = 'secondary';\n        }\n        if((alarmLow > temp)){\n            newBackground = \"primary\";\n            newText = 'white';\n            newIsAlarming = true;\n        }\n        if((temp > alarmHigh)){\n            newBackground = \"danger\";\n            newText=\"white\";\n            newIsAlarming = true;\n        }\n        this.setState({...this.state, name:nextProps.name, probe:nextProps.probe, background:newBackground, text:newText, isAlarming:newIsAlarming});  \n      }\n\n    render() {\n        return(\n            <>\n            <div className=\"row cardContainer\">\n                <Card className=\"col card\" style={{cursor: 'pointer'}} text={this.state.text} bg={this.state.background} border=\"dark\" >\n                    <Card.Title style={{textAlign:\"center\"}}>{this.state.name}</Card.Title>\n                    <Card.Body style={{padding:0}}>\n                    <Container fluid>\n                        <Row style={{padding:0}}>\n                            <Col xs=\"4\" style={{padding:0}}>\n                                <Row style={{padding:0}}><Col><Row style={{fontSize:\"xx-small\", padding:0, margin:0}}>MinAlarm</Row><Row style={{fontSize:\"large\", padding:0, margin:0}}>{this.state.probe.alarmLow}</Row></Col></Row>\n                                <Row style={{padding:0}}><Col><Row style={{fontSize:\"xx-small\", padding:0, margin:0}}>MaxAlarm</Row><Row style={{fontSize:\"large\", padding:0, margin:0}}>{this.state.probe.alarmHigh}</Row></Col></Row>\n                            </Col>\n                            <Col xs=\"4\" style={{padding:0}}>\n                                <Row style={{fontSize:\"xxx-large\", writingMode:\"vertical-lr\", padding:0}}>{this.state.probe.temp}Â°</Row>\n                            </Col>\n                            <Col xs=\"4\" style={{padding:0}}>\n                                <Row style={{padding:0}}><Col><Row style={{fontSize:\"xx-small\", padding:0, margin:0}}>Min</Row><Row style={{fontSize:\"large\", padding:0, margin:0}}>{this.state.probe.min}</Row></Col></Row>\n                                <Row style={{padding:0}}><Col><Row style={{fontSize:\"xx-small\", padding:0, margin:0}}>Max</Row><Row style={{fontSize:\"large\", padding:0, margin:0}}>{this.state.probe.max}</Row></Col></Row>\n                            </Col>\n                        </Row>\n                    </Container>\n                    <Sound url={alarmFile} playStatus={this.state.isAlarming?Sound.status.PLAYING:Sound.status.STOPPED} loop={true}/>\n                    </Card.Body>\n                </Card>\n            </div>\n            </>\n        )\n    }\n\n  }\n\n  export default TempDisplay;\n\n","import React, { Component } from 'react';\nimport './App.css';\nimport CardDeck from 'react-bootstrap/CardDeck'\nimport TempDisplay from './TempDisplay'\n\n\n\ninterface MyProps {\n    //Remove me\n    curTemps:Map<string, { 'date': Date; 'value': Number; }>,\n    probeDetails:Map<string, { \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string}>;\n};\ninterface MyState {\n    curTemps:Map<string, { 'date': Date; 'value': Number; }>,\n    probeDetails:Map<string, { \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string}>;\n}\n  class TempColumn extends Component<MyProps, MyState> {\n    constructor(props:MyProps){\n        super(props);\n\n        this.state =  {\n            curTemps:props.curTemps,\n            probeDetails:props.probeDetails\n        }\n    }\n\n    componentWillReceiveProps(nextProps:MyProps) {\n        this.setState({ curTemps: nextProps.curTemps, probeDetails:nextProps.probeDetails  });  \n    }\n\n    render() {\n        var TempElements:Array<JSX.Element> = [];\n        this.state.probeDetails.forEach((device, key) => \n            TempElements.push(<TempDisplay name={key} probe={device}/>)\n    )\n        return(\n            <>\n            <div id=\"cardDeckContainer\" className=\"row\">\n                <CardDeck id=\"cardDeck\" className=\"col\">\n                    {TempElements}\n                </CardDeck>\n            </div>\n            </>\n        )\n    }\n\n  }\n\n  export default TempColumn;","import React, { Component } from 'react';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport './App.css';\nimport MetricsGraphics from 'react-metrics-graphics';\nimport LoginModal from './LoginModal';\nimport {ThermoworksFirebase} from './ThermoworksFirebase';\nimport 'jquery';\nimport TempColumn from './TempColumn';\nimport './mggraphics.css';\nimport GithubCorner from 'react-github-corner';\nimport ContainerDimensions from 'react-container-dimensions';\nimport Button from 'react-bootstrap/Button';\nimport * as FileSaver from 'file-saver';\nimport * as XLSX from 'xlsx';\n\ninterface MyProps {\n\n};\ninterface MyState {\n  firebase: ThermoworksFirebase\n  tempData:Array<Array<{ 'date': Date; 'value': number; }>>;\n  curTemps:Map<string, { 'date': Date; 'value': number; }>;\n  probeDetails:Map<string, { \"temp\":string, \"date\":Date, \"alarm\":boolean, \"alarmHigh\":string, \"alarmLow\":string, \"max\":string, \"min\":string, \"name\":string}>;\n  showLogin:boolean;\n  baselines:Array<{value:number, label:string}>;\n};\nclass App extends Component<{}, MyState> {\n  constructor(state:MyProps){\n    super(state);\n\n    this.state = {\n      firebase: new ThermoworksFirebase(),\n      tempData:  [],\n      baselines: [],\n      curTemps: new Map(),\n      probeDetails: new Map(),\n      showLogin:true\n    };\n  }\n\n  async onLogin(username:string, password:string){\n    this.state.firebase.setCredentials(username, password);\n    this.state.firebase.setOnTempUpdate(this.onTempUpdate.bind(this));\n    await this.state.firebase.init();\n    this.setState({...this.state, showLogin:false})\n  }\n\nonTempUpdate(){\n    //Store most recent data as Map for display\n    var newCurTemps:Map<string, { 'date': Date; 'value': number; }> = new Map();\n    this.state.firebase.returnTempData().forEach((probe, key)=>{\n      newCurTemps.set(key, probe[probe.length-1]);\n    })\n\n    //Store all data as Array of Arrays for graph\n    var newTemps:Array<Array<{ 'date': Date; 'value': number; }>>=[];\n    this.state.firebase.returnTempData().forEach((probe)=>{\n      if(probe.length!==0){//the graph componant chokes if it's passed empty datasets.\n        newTemps.push(probe);\n      }\n    })\n\n    var newProbeDetails = this.state.firebase.returnProbeDetails();\n\n    var newBaselines:Array<{value:number, label:string}> =  [];\n    this.state.firebase.returnProbeDetails().forEach((value, key) => {\n      newBaselines.push({value:Number(value.alarmHigh), label:key+\" High\"});\n      if(value.alarmLow!==\"32\"){\n        newBaselines.push({value:Number(value.alarmLow), label:key+\" Low\"})\n      }\n    })\n\n    this.setState({...this.state, \n      tempData:newTemps, curTemps:newCurTemps, probeDetails:newProbeDetails, baselines:newBaselines\n    });\n  }\n\n  async exportXLSX(){\n    const fileType = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n    const fileExtension = '.xlsx';\n\n    //create book\n    var wb = XLSX.utils.book_new();\n    wb.Props = {\n      Title: \"ThermoWorks Temperature Log\"\n    }\n\n    this.state.firebase.returnTempData().forEach((value, key) => {\n      if(value.length!==0){\n        var sheetname = key.replace(':','-'); //xlsx silently fails once there are colons in the sheet name\n        wb.SheetNames.push(sheetname);\n        wb.Sheets[sheetname] = XLSX.utils.json_to_sheet(value);\n      }\n      \n    })\n\n    //write the book out and stream it to the browser as a file\n    var wbout = XLSX.write(wb, {bookType:'xlsx',  type: 'array'});\n    const data = new Blob([wbout], {type: fileType});\n    FileSaver.saveAs(data, \"Temps\" + fileExtension);\n  }\n\n  render() {\n    return (\n      <div id=\"App\" style={{padding:0, margin:15}} className=\"row\">\n        <GithubCorner href=\"https://github.com/dlgreenwald/SignalsMontior\" direction=\"left\" octoColor=\"#212529\" bannerColor=\"grey\" />\n        <div id=\"container\"  style={{marginTop:45}} className=\"col\">\n          <div id=\"headerContainer\" className=\"row\">\n            <div id=\"header\">\n              Better Thermoworks Monitor\n            </div>\n          </div>\n          <div id=\"body\" className=\"row\">\n            <div id=\"irbe\">\n              <div id=\"graphContainer\" className=\"row\">\n                <ContainerDimensions>\n                  {({ width, height }) =>\n                    <MetricsGraphics\n                      data={this.state.tempData}\n                      width={width}\n                      height={600}\n                      x_accessor=\"date\"\n                      y_accessor=\"value\"\n                      right=\"40\"\n                      area=\"false\"\n                      brush=\"xy\"\n                      baselines={this.state.baselines}\n                    />\n                  }\n                </ContainerDimensions>\n              </div>\n              <TempColumn curTemps={this.state.curTemps} probeDetails={this.state.probeDetails} />\n              <div id=\"buttonContainer\" className=\"row\">\n                <div id=\"buttons\" className=\"col\">\n                  <LoginModal show={this.state.showLogin} onLogin={this.onLogin.bind(this)} />\n                  <Button style={{width:\"250px\", margin:\"15px\"}} onClick={this.exportXLSX.bind(this)}>Download *.xlsx</Button>\n                </div>\n              </div>\n            </div>\n          </div>  \n          <div id=\"footer\" className=\"row\">\n            <div id=\"footerContainer\" className=\"col\">\n              \n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}